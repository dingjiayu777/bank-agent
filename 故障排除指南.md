# 故障排除指南

## 常见错误及解决方案

### 1. 错误 402 - Insufficient Balance（余额不足）

**错误信息：**
```
Error code: 402 - {'error': {'message': 'Insufficient Balance', ...}}
```

**原因：**
- API 账户余额不足
- 免费额度已用完
- 账户未充值

**解决方案：**

#### DeepSeek 用户：
1. 访问 https://platform.deepseek.com
2. 登录您的账户
3. 查看账户余额
4. 如果余额不足，请充值
5. 确认 API Key 正确

#### OpenAI 用户：
1. 访问 https://platform.openai.com
2. 登录您的账户
3. 查看账户余额和使用情况
4. 如果余额不足，请充值
5. 确认 API Key 正确

**检查步骤：**
- 在浏览器中打开对应的平台网站
- 登录后查看 "Billing" 或 "账户余额" 页面
- 确认账户状态和余额

---

### 2. 错误 401 - Unauthorized（未授权）

**错误信息：**
```
401 - Unauthorized
Invalid API Key
```

**原因：**
- API Key 错误
- API Key 已过期
- API Key 格式不正确

**解决方案：**
1. 检查 API Key 是否正确复制（注意前后空格）
2. 在侧边栏重新输入 API Key
3. 确认 API Key 来自正确的平台（DeepSeek 或 OpenAI）
4. 如果使用 DeepSeek，确保 API Key 格式为：`sk-...`
5. 重新生成 API Key（如果可能）

---

### 3. 错误 429 - Rate Limit（请求频率限制）

**错误信息：**
```
429 - Rate limit exceeded
Too many requests
```

**原因：**
- 请求频率过高
- 达到免费账户的请求限制
- API 配额已用完

**解决方案：**
1. 等待几分钟后重试
2. 如果是免费账户，考虑升级到付费计划
3. 检查 API 使用配额和限制
4. 减少请求频率

---

### 4. 错误 404 - Model Not Found（模型不存在）

**错误信息：**
```
404 - Model not found
Model does not exist
```

**原因：**
- 模型名称错误
- 账户无权使用该模型
- 模型在当前区域不可用

**解决方案：**
1. 检查模型名称是否正确：
   - DeepSeek: `deepseek-chat`, `deepseek-chat-v2`
   - OpenAI: `gpt-3.5-turbo`, `gpt-4`
2. 尝试切换到其他模型
3. 确认账户有权限使用该模型
4. 检查模型是否在您的区域可用

---

### 5. 导入错误 - AgentExecutor

**错误信息：**
```
cannot import name 'AgentExecutor' from 'langchain.agents'
```

**解决方案：**
已自动修复。如果仍遇到此问题，运行：
```bash
python -m pip install langchain-classic
```

---

## 快速检查清单

在遇到问题时，请按以下顺序检查：

- [ ] **API Key 是否正确**
  - 检查是否完整复制
  - 确认没有多余的空格
  - 验证来自正确的平台

- [ ] **账户余额是否充足**
  - 登录平台查看余额
  - 检查是否有未支付的账单
  - 确认账户状态正常

- [ ] **模型配置是否正确**
  - 模型名称拼写正确
  - 账户有权限使用该模型
  - 模型在当前区域可用

- [ ] **网络连接是否正常**
  - 检查网络连接
  - 确认可以访问 API 服务
  - 检查防火墙设置

- [ ] **依赖包是否已安装**
  - 运行 `check_environment.bat` 检查
  - 确认所有依赖已正确安装
  - 检查 Python 版本（需要 3.8+）

---

## 获取帮助

如果以上方法都无法解决问题：

1. **查看详细错误信息**
   - 在应用界面查看完整错误提示
   - 检查浏览器控制台（F12）
   - 查看终端输出

2. **联系 API 服务提供商**
   - DeepSeek: https://platform.deepseek.com
   - OpenAI: https://platform.openai.com/support

3. **检查项目文档**
   - 查看 README.md
   - 查看安装指南.md

---

## 预防措施

1. **定期检查账户余额**
   - 设置余额提醒
   - 定期查看使用情况

2. **使用正确的 API Key**
   - 妥善保管 API Key
   - 不要分享给他人
   - 定期轮换 API Key

3. **监控 API 使用**
   - 查看使用统计
   - 设置使用限制
   - 避免超出配额

